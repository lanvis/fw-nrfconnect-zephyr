#
# Copyright (c) 2018 Nordic Semiconductor ASA
#
# SPDX-License-Identifier: Apache-2.0
#
config SECURE_BOOT_CRYPTO
	bool
	prompt "Secure Boot Crypto library" if ZTEST
	help
	  Only meant to be enabled separately from SECURE_BOOT when testing.

if (SECURE_BOOT_CRYPTO)

config SB_NRF_OBERON
	bool
config SB_NRF_CC310_BL
	bool
config SB_ECDSA
	bool
config SB_RSA
	bool

config SB_SIGNATURE_LEN
	int
	default 64 if SB_ECDSA
	default 256 if SB_RSA

config SB_PUBLIC_KEY_LEN
	int
	default 64 if SB_ECDSA
	default 256 if SB_RSA

config SB_HASH_LEN
	int
	default 32

menu "Secure Boot Crypto Options"

choice SB_CRYPTO_SIG
	prompt "Crypto implementation to use for signature verification of firmware in BL0."
	default SB_CRYPTO_OBERON_ECDSA_SECP256R1

	config SB_CRYPTO_OBERON_ECDSA_SECP256R1
		bool "Software implementation of ECDSA with NIST curve secp256r1."
		select SB_NRF_OBERON
		select SB_ECDSA

	config SB_CRYPTO_OBERON_RSA_2048
		bool "Software implementation of RSASSA-PSS, 2048 bits"
		select SB_NRF_OBERON
		select SB_RSA

	config SB_CRYPTO_CC310_ECDSA_SECP256R1
		bool "Hardware implementation of ECDSA with NIST curve secp256r1." if HAS_HW_NRF_CC310
		select SB_NRF_CC310_BL
		select SB_ECDSA

	config SB_CRYPTO_CC310_RSA_2048
		bool "Hardware implementation of RSASSA-PSS, 2048 bits" if HAS_HW_NRF_CC310
		select SB_NRF_CC310_BL
		select SB_RSA
endchoice

choice SB_CRYPTO_HASH
	prompt "Crypto implementation to use for hash generation in BL0."
	default SB_CRYPTO_OBERON_SHA256

	config SB_CRYPTO_OBERON_SHA256
		bool "Software implementation of SHA256."
		select SB_NRF_OBERON

	config SB_CRYPTO_CC310_SHA256
		bool "Hardware implementation of SHA256" if HAS_HW_NRF_CC310
		select SB_NRF_CC310_BL
endchoice

endmenu
endif # SECURE_BOOT_CRYPTO
